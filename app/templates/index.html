<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Welcome to Helpdesk</title>

  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"/>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

  <style>
    .welcome-container{display:flex;flex-direction:column;align-items:center;justify-content:center;height:calc(100vh - 160px);background:#fff;box-shadow:0 4px 10px rgba(0,0,0,.1);margin:20px auto;max-width:1200px;padding:60px;border-radius:12px;text-align:center}
    h1{font-size:clamp(28px,5vw,48px);line-height:1.2}
    p{font-size:18px;color:#495057;margin-top:15px;max-width:800px}
    .quick-search{margin-top:30px;display:flex;justify-content:center;gap:10px;max-width:600px;width:100%}
    #searchInput{flex:1;padding:10px 15px;font-size:16px;border:1.5px solid #ccc;border-radius:8px 0 0 8px;outline:none;transition:border-color .3s}
    #searchInput:focus{border-color:#232f3e}
    #searchButton{background:#232f3e;border:none;color:#fff;padding:0 20px;border-radius:0 8px 8px 0;cursor:pointer;font-size:16px}
    #searchButton:hover{background:#ffa500}
    .quick-links{margin-top:40px;display:flex;justify-content:center;gap:15px;flex-wrap:wrap}
    .quick-links .btn{min-width:160px;font-size:18px;display:flex;align-items:center;justify-content:center;gap:8px;padding:12px 20px;border-radius:10px;transition:background-color .3s;line-height:1.2;height:50px}
    .quick-links .btn i{font-size:18px;line-height:1;vertical-align:middle}
    .quick-links .btn:hover{opacity:.85}
    .announcements{margin-top:50px;max-width:800px;text-align:left}
    .announcements h2{color:#232f3e;margin-bottom:15px;border-bottom:2px solid #ffa500;padding-bottom:5px}
    .announcements ul{list-style:none}
    .announcements li{padding:8px 0;border-bottom:1px solid #ddd;color:#495057}
    footer{margin:30px 0;text-align:center}
    @media (max-width:768px){.welcome-container{height:auto;padding:60px;margin:10px;max-width:95%}}
  </style>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
<header class="header">
  <a href="{{ url_for('home') }}">
    <img src="{{ url_for('static', filename='logo.png') }}" alt="Helpdesk Logo"/>
  </a>
  <div class="hamburger" onclick="toggleNav()" role="button" tabindex="0" aria-label="Toggle navigation">
    <div class="bar"></div><div class="bar"></div><div class="bar"></div>
  </div>
  <nav class="nav" id="navbar" aria-label="Primary Navigation">
    <a href="{{ url_for('submit_ticket') }}">Submit a Ticket</a>
    <a href="{{ url_for('tickets') }}">View Tickets</a>
    {% if 'username' in session %}
      <a href="{{ url_for('logout') }}" class="btn btn-danger" onclick="return confirmLogout(event)">Logout</a>
    {% else %}
      <a href="{{ url_for('login') }}" class="btn btn-warning">Login</a>
    {% endif %}
  </nav>
</header>

{% with messages = get_flashed_messages(with_categories=true) %}
{% if messages %}
  {% for category, message in messages %}
    <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
      {{ message }}
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
  {% endfor %}
{% endif %}
{% endwith %}

<div class="welcome-container" role="main">

  {% if 'username' in session %}
    <h1 class="user-greeting">Hello, <strong>{{ session['username'] }}</strong>!</h1>
  {% endif %}
  <p>Weâ€™re here to assist you with all your queries and issues. Feel free to explore our help topics or submit a ticket for personalised support.</p>

  <div class="quick-links" role="navigation" aria-label="Quick Links">
    <button onclick="location.href='{{ url_for('submit_ticket') }}'" class="btn btn-success" aria-label="Submit a Ticket">
      <i class="fas fa-plus-circle"></i> Submit a Ticket
    </button>
    <button onclick="location.href='{{ url_for('tickets') }}'" class="btn btn-primary" aria-label="View My Tickets">
      <i class="fas fa-ticket-alt"></i> View My Tickets
    </button>
    <button onclick="location.href='/faq'" class="btn btn-info" aria-label="FAQ">
      <i class="fas fa-question-circle"></i> FAQ
    </button>
  </div>

  <section class="announcements" aria-live="polite" aria-atomic="true" aria-relevant="additions removals">
    <h2>Latest Announcements</h2>
    <ul>
      {% for announcement in announcements %}
        <li><strong>{{ announcement.date.strftime('%b %d, %Y') }}:</strong> {{ announcement.message }}</li>
      {% else %}
        <li>No announcements at this time. Check back soon!</li>
      {% endfor %}
    </ul>
  </section>
</div>

<footer>&copy; {{ current_year }} Apprentice Helpdesk. All rights reserved.</footer>

<script>
  function toggleNav(){const nav=document.getElementById('navbar'); if(nav) nav.classList.toggle('active');}
  function confirmLogout(e){ if(e) e.preventDefault(); Swal.fire({title:'Are you sure you want to logout?',icon:'warning',showCancelButton:true,confirmButtonColor:'#dc3545',cancelButtonColor:'#6c757d',confirmButtonText:'Logout'}).then((r)=>{if(r.isConfirmed){window.location.href='{{ url_for("logout") }}';}}); return false;}
  // Fade out success alerts after 2s
  $(function(){ const $s=$(".alert.alert-success"); if($s.length){ setTimeout(function(){ $s.fadeTo(400,0).slideUp(400,function(){$(this).remove();}); },2000); }});
</script>
</body>
</html>
