<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>FAQ - Apprentice Helpdesk</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"/>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        .main-section {
          font-family: 'Helvetica Neue', Arial, sans-serif;
          color: #333;
          padding: 20px;
          max-width: 900px;
          margin: auto;
        }

        h1 {
          color: #232f3e;
          text-align: center;
          margin: 20px 0 30px;
          font-weight: 700;
        }

        #faqSearch {
          width: 100%;
          padding: 12px 15px;
          font-size: 16px;
          border: 2px solid #232f3e;
          border-radius: 10px;
          margin-bottom: 30px;
          outline: none;
          transition: border-color 0.3s ease;
        }

        #faqSearch:focus {
          border-color: #ffa500;
        }

        .faq-item {
          background: white;
          border-radius: 10px;
          margin-bottom: 15px;
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
          overflow: hidden;
        }

        .faq-question {
          padding: 20px 25px;
          cursor: pointer;
          font-size: 18px;
          font-weight: 600;
          color: #232f3e;
          display: flex;
          justify-content: space-between;
          align-items: center;
          user-select: none;
          transition: background-color 0.3s ease;
        }

        .faq-question:hover {
          background-color: #ffa500;
          color: white;
        }

      .faq-answer {
        display: none;
        padding: 0 25px;
        font-size: 16px;
        color: #495057;
        line-height: 1.5;
        box-sizing: border-box;
      }

      .faq-answer.open {
        display: block;
        padding: 20px 25px 25px;
      }

        .rotate-icon {
          transition: transform 0.3s ease;
        }

        .rotate-icon.open {
          transform: rotate(180deg);
        }

        @media (max-width: 600px) {
          .faq-question {
            font-size: 16px;
            padding: 15px 20px;
          }

          .faq-answer {
            font-size: 14px;
          }
        }
    </style>
</head>

<body>
<header class="header">
    <a href="{{ url_for('home') }}">
        <img src="{{ url_for('static', filename='logo.png') }}" alt="Helpdesk Logo">
    </a>
    <div class="hamburger" onclick="toggleNav()">
        <div class="bar"></div>
        <div class="bar"></div>
        <div class="bar"></div>
    </div>
    <nav class="nav" id="navbar">
        <a href="{{ url_for('submit_ticket') }}">Submit a Ticket</a>
        <a href="{{ url_for('tickets') }}">View Tickets</a>
        <a href="{{ url_for('faq') }}">FAQ</a>
        {% if 'username' in session %}
        {% if session['role'] == 'admin' %}
        <a href="{{ url_for('admin_users') }}">Manage Users</a>
        {% endif %}
        <a href="#" class="btn btn-danger" onclick="confirmLogout(event)">Logout</a>
        {% else %}
        <a href="{{ url_for('login') }}" class="btn btn-warning">Login</a>
        {% endif %}
    </nav>
</header>

<div class="main-section">
    <h1>Frequently Asked Questions</h1>

    <input type="text" id="faqSearch" placeholder="Search FAQs..." aria-label="Search Frequently Asked Questions"/>

    <div id="faqList">
        {% for faq in [
        {'q': 'How do I reset my password?', 'a': 'To reset your password, go to the login page and click "Forgot
        Password". Follow the instructions sent to your email.'},
        {'q': 'How do I submit a support ticket?', 'a': 'Navigate to the "Submit a Ticket" page, fill in the required
        details, and submit your request.'},
        {'q': 'Who can view my submitted tickets?', 'a': 'Only you and administrators can view your submitted
        tickets.'},
        {'q': 'What is the typical response time for tickets?', 'a': 'We aim to respond within 24 hours during business
        days.'},
        {'q': 'Can I track the status of my ticket?', 'a': 'Yes! Log in to your account and visit the "View Tickets"
        page to check status updates.'}
        ] %}
        <div class="faq-item">
            <div class="faq-question" tabindex="0">
                {{ faq.q }}
                <i class="fas fa-chevron-down rotate-icon" aria-hidden="true"></i>
            </div>
            <div class="faq-answer">
                <p>{{ faq.a }}</p>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<script>
    $('.faq-question').on('click keydown', function (e) {
      if (e.type === 'click' || e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        const $question = $(this);
        const $answer = $question.next('.faq-answer');
        const isOpen = $answer.hasClass('open');

        // Close all
        $('.faq-answer').removeClass('open').slideUp(200);
        $('.rotate-icon').removeClass('open');

        // Open clicked one
        if (!isOpen) {
          $answer.addClass('open').slideDown(200);
          $question.find('.rotate-icon').addClass('open');
        }
      }
    });

      // Search
      $('#faqSearch').on('input', function () {
        const query = $(this).val().toLowerCase();
        $('.faq-item').each(function () {
          const question = $(this).find('.faq-question').text().toLowerCase();
          const answer = $(this).find('.faq-answer').text().toLowerCase();
          $(this).toggle(question.includes(query) || answer.includes(query));
        });
      });

      // Hamburger toggle
      function toggleNav() {
        document.getElementById('navbar').classList.toggle('active');
      }

      // SweetAlert2 Logout
      function confirmLogout(event) {
        event.preventDefault();
        Swal.fire({
          title: 'Are you sure you want to log out?',
          icon: 'warning',
          showCancelButton: true,
          confirmButtonColor: '#d33',
          cancelButtonColor: '#3085d6',
          confirmButtonText: 'Yes, log out'
        }).then((result) => {
          if (result.isConfirmed) {
            window.location.href = "{{ url_for('logout') }}";
          }
        });
      }
</script>
</body>
</html>
